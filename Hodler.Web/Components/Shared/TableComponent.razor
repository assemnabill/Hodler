// TODO: extract code from transaction table and generalize for reusability